import { pgTable, text, timestamp } from 'drizzle-orm/pg-core';

// Hello and welcome to the schema file!
// 1. run `doppler run npx drizzle-kit generate:pg` to generate migrations
// 2. (IMPORTANT) if you are creating new tables you would need to manually
//    edit SQL file to add row level security policies
// 3. once this is done, run `doppler run yarn migrate` to apply the migration
// 4. don't forget to run `doppler run yarn migrate --config prd` to apply migrations in production

/* ```sql
ALTER TABLE prompts ENABLE ROW LEVEL SECURITY;
CREATE POLICY "service" ON "public"."prompts" AS PERMISSIVE FOR ALL TO service_role USING (true);
``` */

/**
 * Users and Organizations are managed by PropelAuth, thus you won't find them here.
 */

export const userStories = pgTable('userStories', {
	id: text('id').primaryKey(),
	projectId: text('projectId').notNull(),
	createdAt: timestamp('created_at').notNull().defaultNow(),
	updatedAt: timestamp('updated_at').notNull().defaultNow(),
});

export const testCases = pgTable('testCases', {
	id: text('id').primaryKey(),
	type: text('type').notNull(), // 'regular' | 'gherkin' | 'cypress-e2e'
	createdAt: timestamp('created_at').notNull().defaultNow(),
	updatedAt: timestamp('updated_at').notNull().defaultNow(),
});
